---
name: 整合測試
status: closed
created: 2026-01-08T17:23:27Z
updated: 2026-01-09T06:58:33Z
github: https://github.com/WOOWTECH/odoo-addons/issues/20
depends_on: [12, 13, 14, 15, 16, 17, 18, 19]
parallel: false
conflicts_with: []
---

# Task: 整合測試

## Description

執行全面的整合測試，包括跨瀏覽器測試、WCAG 對比度驗證、Odoo Portal 共存測試、效能基準測試，以及功能迴歸測試。

## Acceptance Criteria

- [ ] Chrome、Firefox、Safari、Edge 最新兩版本測試通過
- [ ] WCAG AA 對比度所有組合通過
- [ ] Odoo Portal 其他頁面無視覺回歸
- [ ] CSS 增量 < 10KB (gzip)
- [ ] 所有 Portal 控制功能正常運作
- [ ] 深色/淺色模式自動切換正常

## Technical Details

### 1. 跨瀏覽器測試

#### 測試矩陣

| 瀏覽器 | 版本 | 平台 | 測試項目 |
|--------|------|------|----------|
| Chrome | 120+ | Windows/Mac | 所有功能 |
| Firefox | 120+ | Windows/Mac | 所有功能 |
| Safari | 17+ | Mac/iOS | 所有功能 |
| Edge | 120+ | Windows | 所有功能 |

#### 測試清單

```markdown
- [ ] 主題變數（CSS Custom Properties）正確載入
- [ ] 深色/淺色模式自動切換
- [ ] 卡片樣式（圓角、陰影）一致
- [ ] Toggle 動畫流暢
- [ ] 滑桿拖動正常（特別注意 Firefox）
- [ ] 動畫效果無卡頓
- [ ] 響應式佈局正確
```

### 2. WCAG 對比度驗證

使用工具：[WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)

#### 需驗證組合

| 模式 | 前景 | 背景 | 最小比率 | 目標 |
|------|------|------|----------|------|
| Light | --portal-text-primary | --portal-bg-primary | 4.5:1 | AA |
| Light | --portal-text-secondary | --portal-bg-card | 4.5:1 | AA |
| Light | --portal-accent-primary | --portal-bg-card | 3:1 | AA (UI) |
| Dark | --portal-text-primary | --portal-bg-primary | 4.5:1 | AA |
| Dark | --portal-text-secondary | --portal-bg-card | 4.5:1 | AA |
| Dark | --portal-accent-success | --portal-bg-card | 3:1 | AA (UI) |

#### 驗證步驟

```bash
# 1. 打開 Portal Entity 頁面
# 2. 開啟 DevTools > Elements
# 3. 檢查 Computed 樣式中的顏色值
# 4. 使用對比度工具驗證
```

### 3. Odoo Portal 共存測試

確保新樣式不影響其他 Portal 頁面：

```markdown
- [ ] /my/home - Portal 首頁
- [ ] /my/account - 帳戶設定
- [ ] /my/security - 安全設定
- [ ] /web - Odoo 後台（不應受影響）
- [ ] /shop - 電商頁面（如有）
```

#### 測試方法

1. 訪問每個頁面
2. 檢查視覺是否有異常
3. 確認無 CSS 污染

### 4. 效能基準測試

#### CSS 檔案大小

```bash
# 測量 portal.scss 編譯後大小
# 原始大小 vs 壓縮大小 vs gzip 大小
wc -c static/src/scss/portal.scss

# 目標：增量 < 10KB (gzip)
```

#### 動畫效能

使用 Chrome DevTools Performance 面板：

```markdown
- [ ] 錄製 Toggle 切換動畫
- [ ] 錄製滑桿拖動
- [ ] 錄製卡片 Hover 效果
- [ ] 確認無 Layout Shift
- [ ] 確認 GPU 加速啟用（使用 will-change）
```

### 5. 功能迴歸測試

#### Portal Entity 頁面

```markdown
- [ ] 頁面正常載入
- [ ] Entity 資訊正確顯示
- [ ] 狀態每 5 秒自動更新
- [ ] Switch Toggle 控制正常
- [ ] Light 亮度滑桿正常
- [ ] Fan 風速控制正常
- [ ] Climate 溫度調整正常
- [ ] Cover 位置控制正常
- [ ] Sensor 數值正確顯示
- [ ] Scene/Script 觸發正常
- [ ] 錯誤狀態顯示正確
- [ ] Loading 狀態顯示正確
```

#### Portal Entity Group 頁面

```markdown
- [ ] 頁面正常載入
- [ ] 卡片網格正確顯示
- [ ] 所有 Entity 狀態正確
- [ ] 統計數據正確（總數/可用/不可用）
- [ ] 個別 Entity 控制正常
- [ ] 狀態自動更新正常
```

### 6. 深色/淺色模式測試

```markdown
- [ ] 系統設定為 Light 時顯示淺色
- [ ] 系統設定為 Dark 時顯示深色
- [ ] 切換系統設定後頁面即時更新（不需重整）
- [ ] 所有元件在兩種模式下視覺正確
```

### 測試報告模板

```markdown
# Portal UI Redesign 測試報告

日期：[YYYY-MM-DD]
測試者：[Name]

## 測試環境
- Odoo 版本：18.0
- 瀏覽器：[versions]
- OS：[versions]

## 測試結果

### 跨瀏覽器 ✅/❌
| 瀏覽器 | 結果 | 備註 |
|--------|------|------|
| Chrome | | |
| Firefox | | |
| Safari | | |
| Edge | | |

### WCAG 對比度 ✅/❌
| 組合 | 比率 | 結果 |
|------|------|------|
| | | |

### 功能測試 ✅/❌
| 功能 | 結果 | 備註 |
|------|------|------|
| | | |

### 效能
- CSS 增量：__ KB (gzip)
- 動畫效能：__ fps

## 問題清單
1. [Issue description]
2. [Issue description]

## 結論
[Pass/Fail with summary]
```

## Dependencies

- [ ] 所有前置任務 (001-008) 必須完成

## Effort Estimate

- Size: M
- Hours: 2
- Parallel: false（最後執行）

## Definition of Done

- [ ] 跨瀏覽器測試報告完成
- [ ] WCAG 驗證報告完成
- [ ] 效能基準記錄
- [ ] 功能迴歸測試通過
- [ ] 所有發現的問題已修復或記錄
- [ ] 測試報告提交
