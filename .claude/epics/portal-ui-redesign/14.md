---
name: 重設計 IoT Toggle Switch 樣式
status: closed
created: 2026-01-08T17:23:27Z
updated: 2026-01-08T23:41:13Z
github: https://github.com/WOOWTECH/odoo-addons/issues/14
depends_on: [12]
parallel: true
conflicts_with: [002, 004, 005]
---

# Task: 重設計 IoT Toggle Switch 樣式

## Description

為 Switch、Light、Fan 等可切換設備設計專業的 IoT 風格 Toggle 開關，包括大型觸控區域、狀態顏色變化、動畫過渡效果。這是 Portal 控制介面中最常用的元件。

## Acceptance Criteria

- [ ] Toggle 觸控區域 ≥ 48x48px
- [ ] ON 狀態顯示綠色（accent-success）
- [ ] OFF 狀態顯示灰色（text-secondary）
- [ ] 狀態切換有 300ms 過渡動畫
- [ ] Hover 時有放大效果（1.05x）
- [ ] Loading 狀態有脈動動畫
- [ ] Disabled 狀態透明度降低

## Technical Details

### 實作位置
`static/src/scss/portal.scss` - 新增 Toggle Switch 區塊

### 樣式規格

```scss
// ========================================
// IoT Toggle Switch
// ========================================

.portal-iot-toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;

  // 主按鈕
  .toggle-button {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 80px;
    min-height: 48px;
    padding: 0.75rem 1rem;
    border: none;
    border-radius: 24px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition:
      background-color var(--portal-transition-normal) ease,
      transform var(--portal-transition-fast) ease,
      box-shadow var(--portal-transition-normal) ease;

    &:hover:not(:disabled) {
      transform: scale(1.05);
    }

    &:active:not(:disabled) {
      transform: scale(0.95);
    }

    // ON 狀態
    &.is-on {
      background-color: var(--portal-accent-success);
      color: white;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
    }

    // OFF 狀態
    &.is-off {
      background-color: var(--portal-text-secondary);
      color: white;
      opacity: 0.8;
    }

    // Loading 狀態
    &.is-loading {
      pointer-events: none;
      animation: portal-pulse 1.5s infinite;
    }

    // Disabled 狀態
    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .toggle-icon {
      margin-right: 0.5rem;
      font-size: 1.1rem;
    }
  }

  // 滑動開關（form-switch 覆蓋）
  .form-switch {
    .form-check-input {
      width: 3.5rem;
      height: 1.75rem;
      cursor: pointer;
      background-color: var(--portal-text-secondary);
      border: none;
      transition: background-color var(--portal-transition-normal) ease;

      &:checked {
        background-color: var(--portal-accent-success);
      }

      &:focus {
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.25);
      }

      &:disabled {
        opacity: 0.5;
      }
    }
  }

  // 狀態 Badge
  .toggle-state-badge {
    padding: 0.375rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.8rem;
    font-weight: 600;

    &.is-on {
      background-color: var(--portal-accent-success);
      color: white;
    }

    &.is-off {
      background-color: var(--portal-text-muted);
      color: white;
    }
  }
}

// 脈動動畫
@keyframes portal-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}
```

### 適用的控制器模板
- `PortalEntityController.Switch`
- `PortalEntityController.Light`
- `PortalEntityController.Fan`
- `PortalEntityController.Automation`
- `PortalEntityController.Script`

### 需要更新的 XML 模板
在 `portal_entity_controller.xml` 中添加新的 CSS 類別：
- 容器添加 `.portal-iot-toggle`
- 按鈕添加 `.toggle-button` + `.is-on` / `.is-off` / `.is-loading`
- Badge 添加 `.toggle-state-badge`

## Dependencies

- [ ] Task 001: CSS Custom Properties 必須先完成
- [ ] Task 007: 模板更新會套用這些類別

## Effort Estimate

- Size: M
- Hours: 2
- Parallel: true（與其他 SCSS 任務可平行）

## Definition of Done

- [ ] Toggle 按鈕樣式完成
- [ ] 滑動開關樣式完成
- [ ] 狀態 Badge 樣式完成
- [ ] 所有過渡動畫流暢
- [ ] 觸控區域 ≥ 48px
- [ ] 深色模式視覺正確
