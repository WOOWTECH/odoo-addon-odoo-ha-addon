---
name: portal-ui-redesign
description: Portal Entity Controller UI ç¾ä»£åŒ–é‡æ–°è¨­è¨ˆ - æ›´å°ˆæ¥­çš„ IoT æ™ºèƒ½è¨­å‚™ä»‹é¢
status: complete
created: 2026-01-08T17:10:21Z
---

# PRD: portal-ui-redesign

## Executive Summary

é‡å°ç¾æœ‰ `share_entities` åŠŸèƒ½ä¸­çš„ Portal é é¢é€²è¡Œ UI/UX ç¾ä»£åŒ–æ”¹é€ ï¼Œå°‡ç›®å‰åå‘å‚³çµ±ä¼æ¥­è»Ÿé«”é¢¨æ ¼çš„ä»‹é¢è½‰è®Šç‚ºæ›´ç¬¦åˆ IoT æ™ºèƒ½è¨­å‚™æ§åˆ¶ä¸­å¿ƒçš„å°ˆæ¥­è¦–è¦ºè¨­è¨ˆã€‚

**æ ¸å¿ƒæ”¹é€²ï¼š**
- ä¿ç•™ Bootstrap/Odoo Portal æ¡†æ¶åŸºç¤ï¼Œå„ªåŒ–å¡ç‰‡å’Œæ§åˆ¶å…ƒä»¶è¨­è¨ˆ
- æ”¯æ´æ·±è‰²/æ·ºè‰²é›™æ¨¡å¼è‡ªå‹•åˆ‡æ›
- å¼•å…¥ç¾ä»£åŒ–æ§åˆ¶å…ƒä»¶ï¼ˆå¤§å‹åœ–ç¤ºæŒ‰éˆ•ã€åœ“å½¢é–‹é—œã€ç²¾ç·»æ»‘æ¡¿ï¼‰
- éŸ¿æ‡‰å¼å¡ç‰‡ç¶²æ ¼ä½ˆå±€ï¼Œé©é…å„ç¨®è¢å¹•å°ºå¯¸
- å³æ™‚ç‹€æ…‹è¦–è¦ºå›é¥‹å‹•ç•«

**è¨­è¨ˆéˆæ„Ÿä¾†æºï¼š**
- [Home Assistant Lovelace å¡ç‰‡è¨­è¨ˆ](https://www.home-assistant.io/dashboards/)
- [Graphite Theme](https://github.com/TilmanGriesel/graphite) - ç°¡æ½”ç¾ä»£çš„ä¸»é¡Œè¨­è¨ˆ
- [SmartHomeScene ä¸»é¡ŒæŒ‡å—](https://smarthomescene.com/blog/best-home-assistant-dashboard-themes-in-2023/)
- [Dribbble IoT Dashboard](https://dribbble.com/tags/iot-dashboard) - è¨­è¨ˆéˆæ„Ÿ
- [GeeksforGeeks Smart Home UI æœ€ä½³å¯¦è¸](https://www.geeksforgeeks.org/designing-ui-for-smart-home-devices/)

## Problem Statement

### ç¾ç‹€å•é¡Œ

1. **è¦–è¦ºé¢¨æ ¼ä¸ç¬¦åˆ IoT è¨­å‚™é æœŸ**ï¼šç›®å‰çš„ Portal é é¢ä½¿ç”¨æ¨™æº– Bootstrap Card æ¨£å¼ï¼Œçœ‹èµ·ä¾†åƒå‚³çµ±ä¼æ¥­è»Ÿé«”è€Œéå°ˆæ¥­æ™ºèƒ½è¨­å‚™æ§åˆ¶å°
2. **æ§åˆ¶å…ƒä»¶ç¼ºä¹å›é¥‹æ„Ÿ**ï¼šç¾æœ‰çš„ Toggle æŒ‰éˆ•å’Œæ»‘æ¡¿ä½¿ç”¨åŸºç¤ Bootstrap æ¨£å¼ï¼Œç¼ºä¹ç‹€æ…‹è®ŠåŒ–çš„è¦–è¦ºå‹•ç•«å’Œè§¸æ§å‹å–„è¨­è¨ˆ
3. **æ·±è‰²æ¨¡å¼ç¼ºå¤±**ï¼šIoT è¨­å‚™ä»‹é¢é€šå¸¸ä»¥æ·±è‰²æ¨¡å¼ç‚ºä¸»ï¼Œä½†ç›®å‰åªæœ‰æ·ºè‰²ç‰ˆæœ¬
4. **è³‡è¨Šå¯†åº¦ä¸ä½³**ï¼šEntity Group é é¢çš„è¡¨æ ¼ä½ˆå±€åœ¨ç§»å‹•è¨­å‚™ä¸Šé–±è®€é«”é©—å·®
5. **ç‹€æ…‹æŒ‡ç¤ºå™¨ä¸ç›´è§€**ï¼šsensor æ•¸å€¼ã€é–‹é—œç‹€æ…‹çš„è¦–è¦ºå‘ˆç¾ç¼ºä¹å±¤æ¬¡æ„Ÿ

### ç‚ºä½•ç¾åœ¨éœ€è¦

- åŸå§‹ `share_entities` åŠŸèƒ½å·²å¯¦ä½œå®Œæˆï¼Œç¾åœ¨æ˜¯å„ªåŒ– UX çš„æœ€ä½³æ™‚æ©Ÿ
- ç”¨æˆ¶å›é¥‹é¡¯ç¤º Portal é é¢ã€Œä¸åƒæ˜¯åœ¨æ§åˆ¶æ™ºèƒ½è¨­å‚™ã€
- ç«¶å“ï¼ˆå¦‚ Home Assistantã€SmartThingsï¼‰çš„ Dashboard è¨­è¨ˆå·²æˆç‚ºæ¥­ç•Œæ¨™æº–
- æ”¯æ´æ·±è‰²æ¨¡å¼æ˜¯ç¾ä»£ Web App çš„åŸºæœ¬è¦æ±‚

## User Stories

### Persona å®šç¾©

| Persona | æè¿° | ä½¿ç”¨æƒ…å¢ƒ |
|---------|------|----------|
| **å¤–éƒ¨è¨ªå®¢** | æ”¶åˆ°åˆ†äº«é€£çµçš„ä½¿ç”¨è€… | é€éæ‰‹æ©Ÿ/å¹³æ¿å¿«é€ŸæŸ¥çœ‹è¨­å‚™ç‹€æ…‹ã€æ§åˆ¶é–‹é—œ |
| **Portal ç”¨æˆ¶** | è¢«é‚€è«‹çš„å¤–éƒ¨ç”¨æˆ¶ | å®šæœŸç›£æ§è¢«æˆæ¬Šçš„è¨­å‚™ç¾¤çµ„ |
| **HA Manager** | å…§éƒ¨ç®¡ç†å“¡ | é©—è­‰åˆ†äº«é€£çµçš„å¤–è§€æ˜¯å¦å°ˆæ¥­ |

---

### US1: ç¾ä»£åŒ–è¨­å‚™æ§åˆ¶é«”é©—

```
As an å¤–éƒ¨è¨ªå®¢
I want to çœ‹åˆ°å°ˆæ¥­çš„ IoT è¨­å‚™æ§åˆ¶ä»‹é¢
So that æˆ‘èƒ½ä¿¡ä»»é€™å€‹ç³»çµ±ä¸¦è¼•é¬†æ“ä½œè¨­å‚™
```

**Acceptance Criteria:**
- [ ] Portal Entity é é¢å‘ˆç¾ç¾ä»£åŒ–å¡ç‰‡è¨­è¨ˆï¼ˆåœ“è§’ã€é™°å½±ã€é–“è·å„ªåŒ–ï¼‰
- [ ] æ§åˆ¶å…ƒä»¶ï¼ˆé–‹é—œã€æ»‘æ¡¿ï¼‰æœ‰æµæš¢çš„å‹•ç•«éæ¸¡æ•ˆæœ
- [ ] ç‹€æ…‹è®ŠåŒ–æ™‚æœ‰æ˜é¡¯çš„è¦–è¦ºå›é¥‹ï¼ˆé¡è‰²è®ŠåŒ–ã€è„ˆå‹•æ•ˆæœï¼‰
- [ ] åœ–ç¤ºä½¿ç”¨å°ˆæ¥­ IoT ç›¸é—œåœ–æ¨™ï¼ˆä¸åªæ˜¯é€šç”¨åœ–ç¤ºï¼‰

### US2: æ·±è‰²/æ·ºè‰²æ¨¡å¼æ”¯æ´

```
As an å¤–éƒ¨è¨ªå®¢
I want to é é¢èƒ½æ ¹æ“šç³»çµ±è¨­å®šè‡ªå‹•åˆ‡æ›æ·±æ·ºæ¨¡å¼
So that å¤œé–“ä½¿ç”¨æ™‚ä¸æœƒåˆºçœ¼
```

**Acceptance Criteria:**
- [ ] æ·±è‰²æ¨¡å¼é…è‰²å°ˆæ¥­ï¼ˆåƒè€ƒ Home Assistant æš—è‰²ä¸»é¡Œï¼‰
- [ ] æ·ºè‰²æ¨¡å¼ä¿æŒæ¸…æ™°å¯è®€
- [ ] æ ¹æ“š `prefers-color-scheme` è‡ªå‹•åˆ‡æ›
- [ ] éæ¸¡å‹•ç•«å¹³æ»‘ï¼ˆä¸çªå…€é–ƒçˆï¼‰

### US3: éŸ¿æ‡‰å¼è¨­å‚™ç¶²æ ¼

```
As an å¤–éƒ¨è¨ªå®¢
I want to åœ¨ Entity Group é é¢çœ‹åˆ°æ¸…æ™°çš„è¨­å‚™å¡ç‰‡ç¶²æ ¼
So that æˆ‘èƒ½å¿«é€Ÿå®šä½ä¸¦æ§åˆ¶ç‰¹å®šè¨­å‚™
```

**Acceptance Criteria:**
- [ ] è¨­å‚™å¡ç‰‡ä»¥éŸ¿æ‡‰å¼ç¶²æ ¼æ’åˆ—ï¼ˆæ‰‹æ©Ÿ 1 æ¬„ã€å¹³æ¿ 2 æ¬„ã€æ¡Œé¢ 3-4 æ¬„ï¼‰
- [ ] æ¯å¼µå¡ç‰‡åŒ…å«ï¼šè¨­å‚™åœ–ç¤ºã€åç¨±ã€ç‹€æ…‹ Badgeã€æ§åˆ¶å…ƒä»¶
- [ ] æ”¯æ´è¨­å‚™ç‹€æ…‹çš„å³æ™‚æ›´æ–°å‹•ç•«
- [ ] å¡ç‰‡ä¹‹é–“æœ‰é©ç•¶é–“è·ï¼Œä¸æœƒæ„Ÿè¦ºæ“æ“ 

### US4: å¢å¼·å‹æ§åˆ¶å…ƒä»¶

```
As an å¤–éƒ¨è¨ªå®¢
I want to ä½¿ç”¨ç›´è¦ºä¸”æ˜“æ–¼è§¸æ§çš„æ§åˆ¶å…ƒä»¶
So that æˆ‘èƒ½åœ¨æ‰‹æ©Ÿä¸Šè¼•é¬†æ“ä½œè¨­å‚™
```

**Acceptance Criteria:**
- [ ] Switch/Light/Fan ä½¿ç”¨å¤§å‹åœ“å½¢ Toggle æŒ‰éˆ•ï¼ˆæœ€å° 48x48px è§¸æ§å€åŸŸï¼‰
- [ ] äº®åº¦/é¢¨é€Ÿæ»‘æ¡¿æœ‰æ¸…æ™°çš„æ•¸å€¼é¡¯ç¤ºå’Œæ‹–å‹•æŠŠæ‰‹
- [ ] Climate æº«åº¦æ§åˆ¶æœ‰ +/- æŒ‰éˆ•å’Œæ•¸å€¼è¼¸å…¥æ¡†
- [ ] æ‰€æœ‰æ§åˆ¶å…ƒä»¶åœ¨ Loading ç‹€æ…‹æœ‰æ˜é¡¯æŒ‡ç¤º
- [ ] éŒ¯èª¤ç‹€æ…‹æœ‰ç´…è‰²æç¤ºå’Œé‡è©¦é¸é …

### US5: Sensor è¦–è¦ºå¢å¼·

```
As an å¤–éƒ¨è¨ªå®¢
I want to çœ‹åˆ°æ„Ÿæ¸¬å™¨æ•¸æ“šä»¥è¦–è¦ºåŒ–æ–¹å¼å‘ˆç¾
So that æˆ‘èƒ½å¿«é€Ÿç†è§£æ•¸å€¼çš„æ„ç¾©
```

**Acceptance Criteria:**
- [ ] æº«åº¦æ„Ÿæ¸¬å™¨é¡¯ç¤ºå¤§å­—é«”æ•¸å€¼ + æº«åº¦è¨ˆåœ–ç¤º
- [ ] æ¿•åº¦æ„Ÿæ¸¬å™¨é¡¯ç¤ºç™¾åˆ†æ¯” + æ°´æ»´åœ–ç¤º
- [ ] äºŒé€²åˆ¶æ„Ÿæ¸¬å™¨ï¼ˆé–€çª—ï¼‰é¡¯ç¤ºé–‹/é—œç‹€æ…‹åœ–ç¤º
- [ ] æ•¸å€¼è®ŠåŒ–æ™‚æœ‰å¹³æ»‘çš„å‹•ç•«éæ¸¡

## Requirements

### Functional Requirements

#### FR1: ä¸»é¡Œç³»çµ±

| ID | Requirement | Priority |
|----|-------------|----------|
| FR1.1 | å¯¦ä½œ CSS Custom Propertiesï¼ˆCSS è®Šæ•¸ï¼‰ä¸»é¡Œç³»çµ± | Must |
| FR1.2 | æ·±è‰²æ¨¡å¼é…è‰²æ–¹æ¡ˆï¼ˆèƒŒæ™¯ #1a1a2e ~ #16213eï¼‰ | Must |
| FR1.3 | æ·ºè‰²æ¨¡å¼é…è‰²æ–¹æ¡ˆï¼ˆèƒŒæ™¯ #f8f9fa ~ #ffffffï¼‰ | Must |
| FR1.4 | `prefers-color-scheme` åª’é«”æŸ¥è©¢è‡ªå‹•åˆ‡æ› | Must |
| FR1.5 | æ‰‹å‹•åˆ‡æ›æŒ‰éˆ•ï¼ˆå¯é¸ï¼‰ | Should |

##### FR1 è¨­è¨ˆè¦æ ¼

```css
/* æ·±è‰²æ¨¡å¼èª¿è‰²æ¿ */
:root[data-theme="dark"], .portal-dark {
  --portal-bg-primary: #1a1a2e;
  --portal-bg-secondary: #16213e;
  --portal-bg-card: #0f3460;
  --portal-text-primary: #e4e4e7;
  --portal-text-secondary: #a1a1aa;
  --portal-accent-primary: #00d9ff;    /* é’è‰²å¼·èª¿ */
  --portal-accent-success: #10b981;    /* ç¶ è‰² - é–‹å•Ÿç‹€æ…‹ */
  --portal-accent-warning: #f59e0b;    /* é»ƒè‰² - è­¦å‘Š */
  --portal-accent-danger: #ef4444;     /* ç´…è‰² - éŒ¯èª¤/é—œé–‰ */
  --portal-border-color: rgba(255, 255, 255, 0.1);
  --portal-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
}

/* æ·ºè‰²æ¨¡å¼èª¿è‰²æ¿ */
:root[data-theme="light"], .portal-light {
  --portal-bg-primary: #f8f9fa;
  --portal-bg-secondary: #e9ecef;
  --portal-bg-card: #ffffff;
  --portal-text-primary: #1f2937;
  --portal-text-secondary: #6b7280;
  --portal-accent-primary: #3b82f6;    /* è—è‰²å¼·èª¿ */
  --portal-accent-success: #10b981;
  --portal-accent-warning: #f59e0b;
  --portal-accent-danger: #ef4444;
  --portal-border-color: rgba(0, 0, 0, 0.1);
  --portal-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}
```

#### FR2: å¡ç‰‡å…ƒä»¶ç³»çµ±

| ID | Requirement | Priority |
|----|-------------|----------|
| FR2.1 | è¨­å‚™å¡ç‰‡åŸºç¤æ¨£å¼ï¼ˆåœ“è§’ 12-16pxã€é™°å½±ã€é‚Šæ¡†ï¼‰ | Must |
| FR2.2 | å¡ç‰‡ Header å€å¡Šï¼ˆåœ–ç¤º + åç¨± + ç‹€æ…‹ Badgeï¼‰ | Must |
| FR2.3 | å¡ç‰‡ Body å€å¡Šï¼ˆæ§åˆ¶å…ƒä»¶æˆ–æ•¸å€¼é¡¯ç¤ºï¼‰ | Must |
| FR2.4 | å¡ç‰‡ Footer å€å¡Šï¼ˆæœ€å¾Œæ›´æ–°æ™‚é–“ï¼‰ | Should |
| FR2.5 | å¡ç‰‡ Hover/Active äº’å‹•æ•ˆæœ | Should |

##### FR2 å¡ç‰‡çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”Œ è¨­å‚™åç¨±                    [ON]  â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚        â—‰ â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â—‹           â”‚  â† Body (æ§åˆ¶å…ƒä»¶)
â”‚          OFF      50%      ON       â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ• æœ€å¾Œæ›´æ–°: 2 åˆ†é˜å‰               â”‚  â† Footer
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### FR3: æ§åˆ¶å…ƒä»¶åº«

| ID | Requirement | Priority |
|----|-------------|----------|
| FR3.1 | IoT Toggle Switchï¼ˆå¤§å‹åœ“å½¢é–‹é—œï¼Œå¸¶å‹•ç•«ï¼‰ | Must |
| FR3.2 | æ•¸å€¼æ»‘æ¡¿ï¼ˆäº®åº¦/é¢¨é€Ÿ/ä½ç½®ï¼Œå¸¶å³æ™‚æ•¸å€¼é¡¯ç¤ºï¼‰ | Must |
| FR3.3 | æº«åº¦æ§åˆ¶å™¨ï¼ˆ+/- æŒ‰éˆ• + æ•¸å€¼æ¡† + ç¯„åœé™åˆ¶ï¼‰ | Must |
| FR3.4 | æ¨¡å¼é¸æ“‡å™¨ï¼ˆæŒ‰éˆ•çµ„æˆ–ä¸‹æ‹‰é¸å–®ï¼‰ | Must |
| FR3.5 | å‹•ä½œæŒ‰éˆ•ï¼ˆScene/Script å•Ÿå‹•æŒ‰éˆ•ï¼‰ | Must |
| FR3.6 | Sensor æ•¸å€¼é¡¯ç¤ºï¼ˆå¤§å­—é«” + å–®ä½ + åœ–ç¤ºï¼‰ | Must |

##### FR3 Toggle Switch è¦æ ¼

```
å°ºå¯¸ï¼š
- è§¸æ§å€åŸŸï¼šæœ€å° 48x48px
- Toggle Trackï¼š64x32px
- Toggle Knobï¼š28x28px

ç‹€æ…‹é¡è‰²ï¼š
- ONï¼švar(--portal-accent-success) ç¶ è‰²èƒŒæ™¯
- OFFï¼švar(--portal-text-secondary) ç°è‰²èƒŒæ™¯
- Loadingï¼šè„ˆå‹•å‹•ç•«
- Disabledï¼šé™ä½é€æ˜åº¦ 50%

å‹•ç•«ï¼š
- ç‹€æ…‹åˆ‡æ›ï¼š300ms ease-in-out
- Hoverï¼šæ”¾å¤§ 1.05x
- Activeï¼šç¸®å° 0.95x
```

#### FR4: éŸ¿æ‡‰å¼ç¶²æ ¼ç³»çµ±

| ID | Requirement | Priority |
|----|-------------|----------|
| FR4.1 | CSS Grid æˆ– Flexbox éŸ¿æ‡‰å¼ä½ˆå±€ | Must |
| FR4.2 | æ–·é»ï¼šmobile (<576px)ã€tablet (576-992px)ã€desktop (>992px) | Must |
| FR4.3 | Entity Group å¡ç‰‡ç¶²æ ¼ï¼š1/2/3/4 æ¬„è‡ªé©æ‡‰ | Must |
| FR4.4 | å¡ç‰‡é–“è·ï¼š16-24pxï¼ˆgapï¼‰ | Must |
| FR4.5 | å®¹å™¨æœ€å¤§å¯¬åº¦ï¼š1200px | Should |

##### FR4 ç¶²æ ¼è¦æ ¼

```css
.portal-entity-grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
}

/* æ–·é»èª¿æ•´ */
@media (max-width: 576px) {
  .portal-entity-grid {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }
}
```

#### FR5: å‹•ç•«ç³»çµ±

| ID | Requirement | Priority |
|----|-------------|----------|
| FR5.1 | ç‹€æ…‹è®ŠåŒ–è„ˆå‹•æ•ˆæœï¼ˆState Change Pulseï¼‰ | Must |
| FR5.2 | å¡ç‰‡è¼‰å…¥éª¨æ¶å±ï¼ˆSkeleton Loadingï¼‰ | Should |
| FR5.3 | æ•¸å€¼è®ŠåŒ–å¹³æ»‘éæ¸¡ï¼ˆNumber Morphingï¼‰ | Should |
| FR5.4 | æ§åˆ¶å…ƒä»¶äº’å‹•åé¥‹ï¼ˆMicro-interactionsï¼‰ | Should |
| FR5.5 | å°Šé‡ `prefers-reduced-motion` è¨­å®š | Must |

### Non-Functional Requirements

#### NFR1: æ•ˆèƒ½

| ID | Requirement | Target |
|----|-------------|--------|
| NFR1.1 | é¦–æ¬¡å…§å®¹ç¹ªè£½ (FCP) | < 1.5s |
| NFR1.2 | CSS å‹•ç•«ä¸é˜»å¡ä¸»åŸ·è¡Œç·’ | ä½¿ç”¨ transform/opacity |
| NFR1.3 | ç„¡ JavaScript ä¾è³´çš„åŸºç¤æ¨£å¼ | CSS-only fallback |

#### NFR2: å¯åŠæ€§

| ID | Requirement | Target |
|----|-------------|--------|
| NFR2.1 | WCAG 2.1 AA å°æ¯”åº¦ | 4.5:1 (æ–‡å­—)ã€3:1 (UI) |
| NFR2.2 | éµç›¤å°èˆªæ”¯æ´ | Tab/Enter/Space |
| NFR2.3 | è¢å¹•é–±è®€å™¨æ”¯æ´ | ARIA æ¨™ç±¤ |
| NFR2.4 | è§¸æ§ç›®æ¨™å°ºå¯¸ | æœ€å° 48x48px |

#### NFR3: ç›¸å®¹æ€§

| ID | Requirement | Target |
|----|-------------|--------|
| NFR3.1 | ç€è¦½å™¨æ”¯æ´ | Chrome/Firefox/Safari/Edge (æœ€è¿‘ 2 ç‰ˆ) |
| NFR3.2 | CSS Custom Properties æ”¯æ´ | åŸç”Ÿæ”¯æ´ï¼ˆç„¡ polyfillï¼‰ |
| NFR3.3 | èˆ‡ç¾æœ‰ Odoo Portal CSS å…±å­˜ | ä¸è¦†è“‹å…¨åŸŸæ¨£å¼ |

## Success Criteria

| Metric | Target | Measurement |
|--------|--------|-------------|
| è¦–è¦ºæ»¿æ„åº¦ | > 4/5 | ç”¨æˆ¶å›é¥‹è©•åˆ† |
| æ·±è‰²æ¨¡å¼ä½¿ç”¨ç‡ | > 40% | åŒ¿ååˆ†æ |
| ç§»å‹•è¨­å‚™æ§åˆ¶æˆåŠŸç‡ | > 95% | éŒ¯èª¤ç‡è¿½è¹¤ |
| CSS æª”æ¡ˆå¤§å° | < 30KB (gzip) | å»ºç½®è¼¸å‡º |
| å°æ¯”åº¦åˆè¦ | 100% | WCAG å·¥å…·æª¢æ¸¬ |

## Technical Architecture

### æª”æ¡ˆçµæ§‹

```
static/src/portal/
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ portal_theme.scss        # ä¸»é¡Œè®Šæ•¸å’ŒåŸºç¤æ¨£å¼
â”‚   â”œâ”€â”€ portal_components.scss   # å…ƒä»¶æ¨£å¼
â”‚   â”œâ”€â”€ portal_animations.scss   # å‹•ç•«å®šç¾©
â”‚   â””â”€â”€ portal_responsive.scss   # éŸ¿æ‡‰å¼æ–·é»
â”œâ”€â”€ portal_entity_controller.js   # (ç¾æœ‰) OWL å…ƒä»¶
â”œâ”€â”€ portal_entity_controller.xml  # (æ›´æ–°) æ¨¡æ¿
â”œâ”€â”€ portal_entity_info.js         # (ç¾æœ‰) OWL å…ƒä»¶
â”œâ”€â”€ portal_entity_info.xml        # (æ›´æ–°) æ¨¡æ¿
â”œâ”€â”€ portal_group_info.js          # (ç¾æœ‰) OWL å…ƒä»¶
â””â”€â”€ portal_group_info.xml         # (æ›´æ–°) æ¨¡æ¿

views/
â””â”€â”€ portal_templates.xml          # (æ›´æ–°) QWeb Portal æ¨¡æ¿
```

### CSS æ¶æ§‹

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    portal_theme.scss        â”‚
                    â”‚  - CSS Custom Properties    â”‚
                    â”‚  - :root è®Šæ•¸å®šç¾©           â”‚
                    â”‚  - prefers-color-scheme     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚                         â”‚
        â–¼                         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ portal_components â”‚   â”‚ portal_animations â”‚   â”‚ portal_responsive â”‚
â”‚ - .portal-card    â”‚   â”‚ - @keyframes pulseâ”‚   â”‚ - @media queries  â”‚
â”‚ - .iot-toggle     â”‚   â”‚ - .state-changed  â”‚   â”‚ - grid adjustmentsâ”‚
â”‚ - .value-slider   â”‚   â”‚ - transitions     â”‚   â”‚ - touch targets   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Constraints & Assumptions

### Constraints

1. **æŠ€è¡“**
   - å¿…é ˆåœ¨ Odoo 18 Portal æ¡†æ¶å…§å¯¦ä½œ
   - CSS æ¨£å¼ä¸èƒ½ç ´å£ç¾æœ‰ Odoo Portal é é¢
   - ä½¿ç”¨ SCSS ç·¨è­¯ç‚º CSSï¼ˆOdoo assets æµç¨‹ï¼‰

2. **è¨­è¨ˆ**
   - é¡è‰²ç³»çµ±å¿…é ˆç¬¦åˆ WCAG 2.1 AA å°æ¯”åº¦æ¨™æº–
   - å‹•ç•«å¿…é ˆå°Šé‡ä½¿ç”¨è€…çš„å‹•æ…‹åå¥½è¨­å®š
   - ä¿æŒèˆ‡ Home Assistant è¨­è¨ˆèªè¨€çš„å”èª¿æ€§

3. **ç¯„åœ**
   - åƒ…å½±éŸ¿ Portal å…¬é–‹é é¢ï¼ˆ`/portal/entity/*`ã€`/portal/entity_group/*`ï¼‰
   - ä¸ä¿®æ”¹ Odoo å¾Œå°ä»‹é¢æ¨£å¼

### Assumptions

1. ä½¿ç”¨è€…è¨­å‚™æ”¯æ´ CSS Custom Properties
2. ä½¿ç”¨è€…åå¥½å°ˆæ¥­çš„ IoT æ§åˆ¶ä¸­å¿ƒè¦–è¦ºé¢¨æ ¼
3. æ·±è‰²æ¨¡å¼æ˜¯ä¸»è¦ä½¿ç”¨æƒ…å¢ƒï¼ˆä½†ä»æä¾›æ·ºè‰²é¸é …ï¼‰
4. ç¾æœ‰ OWL å…ƒä»¶çµæ§‹å¯é‡ç”¨ï¼Œåªéœ€æ›´æ–°æ¨¡æ¿å’Œæ¨£å¼

## Out of Scope

ä»¥ä¸‹åŠŸèƒ½ä¸åœ¨æœ¬ PRD ç¯„åœå…§ï¼š

1. **è‡ªè¨‚ä¸»é¡Œç·¨è¼¯å™¨** - ä½¿ç”¨è€…ç„¡æ³•è‡ªè¨‚é¡è‰²/å­—é«”
2. **å‹•æ…‹çš®è†šåˆ‡æ› UI** - åƒ…æ”¯æ´ç³»çµ±ç´šæ·±æ·ºæ¨¡å¼
3. **Odoo å¾Œå°æ¨£å¼æ›´æ”¹** - åƒ…é™ Portal é é¢
4. **ç¬¬ä¸‰æ–¹åœ–ç¤ºåº«æ•´åˆ** - ç¹¼çºŒä½¿ç”¨ Font Awesome 4.x
5. **é€²éšè³‡æ–™è¦–è¦ºåŒ–** - ä¸å«åœ–è¡¨/æ­·å²è¶¨å‹¢ç·š
6. **å®¢è£½åŒ–å¡ç‰‡æ’åº/æ‹–æ›³** - å›ºå®šä½ˆå±€

## Dependencies

### External Dependencies

| Dependency | Type | Description |
|------------|------|-------------|
| Odoo Portal | Module | åŸºç¤ Portal æ¡†æ¶å’Œ QWeb æ¨¡æ¿ |
| Bootstrap 4 | CSS | ç¾æœ‰ Odoo Portal CSS æ¡†æ¶ |
| Font Awesome 4.x | Icons | ç¾æœ‰åœ–ç¤ºåº« |
| OWL Framework | JS | ç¾æœ‰å‰ç«¯å…ƒä»¶æ¡†æ¶ |

### Internal Dependencies

| Dependency | Description |
|------------|-------------|
| `share_entities` PRD | å¿…é ˆå…ˆå®ŒæˆåŸºç¤ Portal åŠŸèƒ½ |
| portal_entity_controller.js | ç¾æœ‰æ§åˆ¶å…ƒä»¶é‚è¼¯ |
| portal_entity_info.js | ç¾æœ‰è³‡è¨Šé¡¯ç¤ºé‚è¼¯ |
| portal_group_info.js | ç¾æœ‰ç¾¤çµ„é¡¯ç¤ºé‚è¼¯ |

## Implementation WBS

### Phase 1: ä¸»é¡Œç³»çµ±åŸºç¤ (1 day)
- [ ] å»ºç«‹ `portal_theme.scss` CSS è®Šæ•¸æ¶æ§‹
- [ ] å¯¦ä½œæ·±è‰²æ¨¡å¼é…è‰²
- [ ] å¯¦ä½œæ·ºè‰²æ¨¡å¼é…è‰²
- [ ] è¨­å®š `prefers-color-scheme` è‡ªå‹•åˆ‡æ›
- [ ] å–®å…ƒæ¸¬è©¦ï¼šå°æ¯”åº¦æª¢æ¸¬

### Phase 2: å¡ç‰‡å…ƒä»¶æ¨£å¼ (1 day)
- [ ] è¨­è¨ˆ `.portal-card` åŸºç¤æ¨£å¼
- [ ] å¯¦ä½œå¡ç‰‡ Header/Body/Footer çµæ§‹
- [ ] åŠ å…¥ Hover/Active äº’å‹•æ•ˆæœ
- [ ] éŸ¿æ‡‰å¼èª¿æ•´

### Phase 3: æ§åˆ¶å…ƒä»¶å‡ç´š (2 days)
- [ ] IoT Toggle Switch é‡æ–°è¨­è¨ˆ
- [ ] æ•¸å€¼æ»‘æ¡¿æ¨£å¼å‡ç´š
- [ ] æº«åº¦æ§åˆ¶å™¨æ¨£å¼
- [ ] æ¨¡å¼é¸æ“‡å™¨æŒ‰éˆ•çµ„
- [ ] Sensor æ•¸å€¼é¡¯ç¤ºå„ªåŒ–
- [ ] Loading ç‹€æ…‹æŒ‡ç¤ºå™¨

### Phase 4: éŸ¿æ‡‰å¼ç¶²æ ¼ (1 day)
- [ ] Entity Group å¡ç‰‡ç¶²æ ¼å¯¦ä½œ
- [ ] æ–·é»æ¸¬è©¦ï¼ˆmobile/tablet/desktopï¼‰
- [ ] è§¸æ§ç›®æ¨™å°ºå¯¸é©—è­‰

### Phase 5: å‹•ç•«ç³»çµ± (1 day)
- [ ] ç‹€æ…‹è®ŠåŒ–è„ˆå‹•æ•ˆæœ
- [ ] æ§åˆ¶å…ƒä»¶äº’å‹•å‹•ç•«
- [ ] `prefers-reduced-motion` æ”¯æ´
- [ ] æ•ˆèƒ½æ¸¬è©¦

### Phase 6: æ•´åˆæ¸¬è©¦ (1 day)
- [ ] è·¨ç€è¦½å™¨æ¸¬è©¦
- [ ] WCAG å°æ¯”åº¦é©—è­‰
- [ ] Odoo Portal å…±å­˜æ¸¬è©¦
- [ ] æ•ˆèƒ½åŸºæº–æ¸¬è©¦
- [ ] Bug fixes

**é ä¼°ç¸½æ™‚ç¨‹ï¼š7 å·¥ä½œå¤©**

## Appendix

### A: è¨­è¨ˆåƒè€ƒ

| åƒè€ƒä¾†æº | é©ç”¨å…ƒç´  | é€£çµ |
|----------|----------|------|
| Home Assistant Tile Card | Toggle æŒ‰éˆ•ã€ç‹€æ…‹å¡ç‰‡ | [HA Dashboards](https://www.home-assistant.io/dashboards/) |
| Graphite Theme | æ·±è‰²æ¨¡å¼é…è‰²ã€å­—é«” | [GitHub](https://github.com/TilmanGriesel/graphite) |
| Material Design 3 | åœ“è§’ã€é™°å½±ã€å‹•ç•«æ™‚åº | [m3.material.io](https://m3.material.io/) |
| Dribbble IoT Dashboard | æ•´é«”ä½ˆå±€éˆæ„Ÿ | [Dribbble](https://dribbble.com/tags/iot-dashboard) |

### B: é¡è‰²å°æ¯”åº¦è¨ˆç®—

| çµ„åˆ | å‰æ™¯ | èƒŒæ™¯ | å°æ¯”åº¦ | åˆè¦ |
|------|------|------|--------|------|
| æ·±è‰²æ¨¡å¼æ–‡å­— | #e4e4e7 | #1a1a2e | 11.2:1 | AAA |
| æ·±è‰²æ¨¡å¼æ¬¡è¦æ–‡å­— | #a1a1aa | #1a1a2e | 5.8:1 | AA |
| æ·ºè‰²æ¨¡å¼æ–‡å­— | #1f2937 | #ffffff | 15.2:1 | AAA |
| æ·ºè‰²æ¨¡å¼æ¬¡è¦æ–‡å­— | #6b7280 | #ffffff | 5.1:1 | AA |
| æˆåŠŸç¶ è‰² on æ·±è‰² | #10b981 | #1a1a2e | 6.9:1 | AA |

### C: åœ–ç¤ºå°ç…§è¡¨

| Domain | å»ºè­°åœ–ç¤º (FA4.x) | æ›¿ä»£ |
|--------|------------------|------|
| switch | fa-toggle-on/off | fa-power-off |
| light | fa-lightbulb-o | fa-sun-o |
| fan | fa-cog (æ—‹è½‰å‹•ç•«) | fa-spinner |
| climate | fa-thermometer-half | fa-snowflake-o |
| cover | fa-window-restore | fa-bars |
| sensor | fa-tachometer | fa-line-chart |
| automation | fa-magic | fa-flash |
| script | fa-file-code-o | fa-terminal |
| scene | fa-picture-o | fa-bookmark |
