<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
  <t t-name="odoo_ha_addon.GlancesBlock">
    <div class="glances-block">
      <h4 class="mb-3">
        <i class="fa fa-server me-2"/>
        Glances
      </h4>

      <!-- Loading -->
      <div t-if="state.loading" class="text-center text-muted py-4">
        <i class="fa fa-spinner fa-spin fa-2x"/>
        <p class="mt-2">Loading Glances devices...</p>
      </div>

      <!-- Error -->
      <div t-elif="state.error" class="alert alert-danger">
        <i class="fa fa-exclamation-triangle me-2"/>
        <span t-esc="state.error"/>
      </div>

      <!-- No devices -->
      <div t-elif="!state.devices.length" class="text-center text-muted py-4">
        <i class="fa fa-info-circle fa-2x"/>
        <p class="mt-2">No Glances devices found</p>
        <small>Please make sure Home Assistant has Glances integration installed</small>
      </div>

      <!-- 設備卡片列表 -->
      <div t-else="" class="row">
        <t t-foreach="state.devices" t-as="device" t-key="device.id">
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="card glances-device-card h-100"
                 t-on-click="() => this.onDeviceCardClick(device)"
                 style="cursor: pointer;">
              <div class="card-body">
                <div class="d-flex align-items-center mb-2">
                  <div class="glances-device-icon me-3">
                    <i t-att-class="getDeviceIcon(device)" class="fa-2x text-primary"/>
                  </div>
                  <div class="flex-grow-1">
                    <h5 class="card-title mb-0" t-esc="device.name"/>
                    <small class="text-muted" t-if="device.model">
                      <span t-esc="device.model"/>
                    </small>
                  </div>
                  <div class="text-end">
                    <i class="fa fa-chevron-right text-muted"/>
                  </div>
                </div>

                <div class="glances-device-details">
                  <p class="mb-1" t-if="device.manufacturer">
                    <small class="text-muted">
                      <i class="fa fa-building me-1"/>
                      <span t-esc="device.manufacturer"/>
                    </small>
                  </p>
                  <p class="mb-0" t-if="device.sw_version">
                    <small class="text-muted">
                      <i class="fa fa-code-fork me-1"/>
                      <span t-esc="formatVersion(device.sw_version)"/>
                    </small>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </t>
      </div>
    </div>
  </t>
</templates>
