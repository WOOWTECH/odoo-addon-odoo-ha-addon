# 命令

**[English Documentation](../COMMANDS.md)**

Claude Code PM 系統中所有可用命令的完整參考。

> **注意**: 專案管理命令（`/pm:*`）在主 [README.md](README.md#command-reference) 中有文件說明。

## 目錄

- [上下文命令](#上下文命令)
- [測試命令](#測試命令)
- [實用命令](#實用命令)
- [審查命令](#審查命令)

## 上下文命令

用於管理 `.claude/context/` 中專案上下文的命令。

### `/context:create`
- **目的**: 建立初始專案上下文文件
- **用法**: `/context:create`
- **描述**: 分析專案結構並在 `.claude/context/` 中建立全面的基線文件。包括專案概述、架構、相依性和模式。
- **使用時機**: 專案開始時或需要完全重建上下文時
- **輸出**: 涵蓋專案不同方面的多個上下文檔案

### `/context:update`
- **目的**: 使用最近的變更更新現有上下文
- **用法**: `/context:update`
- **描述**: 根據最近的程式碼變更、新功能或架構更新刷新上下文文件。保留現有上下文同時新增新資訊。
- **使用時機**: 重大變更後或主要工作階段前
- **輸出**: 帶有變更追蹤的更新上下文檔案

### `/context:prime`
- **目的**: 將上下文載入到當前對話中
- **用法**: `/context:prime`
- **描述**: 讀取所有上下文檔案並將其載入到當前對話的記憶體中。對於保持專案意識至關重要。
- **使用時機**: 任何工作階段開始時
- **輸出**: 已載入上下文的確認資訊

## 測試命令

用於測試設定和執行的命令。

### `/testing:prime`
- **目的**: 設定測試配置
- **用法**: `/testing:prime`
- **描述**: 偵測和設定專案的測試框架，建立測試設定，並準備測試執行代理。
- **使用時機**: 初始專案設定或測試框架變更時
- **輸出**: 包含測試命令和模式的 `.claude/testing-config.md`

### `/testing:run`
- **目的**: 執行具有智慧分析的測試
- **用法**: `/testing:run [測試目標]`
- **描述**: 使用測試執行代理執行測試，該代理將輸出擷取到日誌中，僅回傳必要結果以保留上下文。
- **選項**:
   - 無參數: 執行所有測試
   - 檔案路徑: 執行特定測試檔案
   - 模式: 執行符合模式的測試
- **輸出**: 具有失敗分析的測試摘要，主執行緒中無詳細輸出

## 實用命令

通用實用程式和維護命令。

### `/prompt`
- **目的**: 處理具有多個參考的複雜提示
- **用法**: 在檔案中撰寫提示，然後輸入 `/prompt`
- **描述**: 用於直接輸入中具有眾多 @ 參考的複雜提示失敗時的臨時命令。提示首先寫入命令檔案，然後執行。
- **使用時機**: 當 Claude 的 UI 拒絕複雜提示時
- **輸出**: 執行寫入的提示

### `/re-init`
- **目的**: 使用 PM 規則更新或建立 CLAUDE.md
- **用法**: `/re-init`
- **描述**: 使用 `.claude/CLAUDE.md` 中的規則更新專案的 CLAUDE.md 檔案，確保 Claude 實例具有正確的指令。
- **使用時機**: 複製 PM 系統後或更新規則後
- **輸出**: 專案根目錄中更新的 CLAUDE.md

## 審查命令

用於處理外部程式碼審查工具的命令。

### `/code-rabbit`
- **目的**: 智慧處理 CodeRabbit 審查註解
- **用法**: `/code-rabbit` 然後貼上註解
- **描述**: 使用上下文意識評估 CodeRabbit 建議，接受有效改進同時忽略缺乏上下文的建議。為多檔案審查產生並行代理。
- **功能**:
   - 理解 CodeRabbit 缺乏完整上下文
   - 接受: 真實錯誤、安全問題、資源洩漏
   - 忽略: 樣式偏好、無關模式
   - 多檔案的並行處理
- **輸出**: 接受/忽略建議的摘要及理由

## 命令模式

所有命令遵循一致的模式：

### 允許的工具
每個命令在 frontmatter 中指定其所需工具：
- `Read, Write, LS` - 檔案操作
- `Bash` - 系統命令
- `Task` - 子代理產生
- `Grep` - 程式碼搜尋

### 錯誤處理
命令遵循快速失敗原則：
- 首先檢查先決條件
- 清晰的錯誤訊息及解決方案
- 永不留下部分狀態

### 上下文保留
處理大量資訊的命令：
- 使用代理保護主執行緒免受詳細輸出影響
- 回傳摘要，而非原始資料
- 僅保留必要資訊

## 建立自訂命令

新增新命令的步驟：

1. **建立檔案**: `commands/category/command-name.md`
2. **新增 frontmatter**:
   ```yaml
   ---
   allowed-tools: Read, Write, LS
   ---
   ```
3. **結構化內容**:
   - 目的和用法
   - 預檢檢查
   - 分步指令
   - 錯誤處理
   - 輸出格式

4. **遵循模式**:
   - 保持簡單（不過度驗證）
   - 快速失敗並提供清晰訊息
   - 使用代理進行繁重處理
   - 回傳簡潔輸出

## 與代理整合

命令經常使用代理進行繁重工作：

- **test-runner**: 執行測試，分析結果
- **file-analyzer**: 總結詳細檔案
- **code-analyzer**: 在程式碼庫中查找錯誤
- **parallel-worker**: 協調並行執行

這使主執行緒上下文保持乾淨，同時完成複雜工作。

## 注意事項

- 命令是作為指令解釋的 markdown 檔案
- `/` 前綴觸發命令執行
- 命令可以產生代理以保留上下文
- 所有 PM 命令（`/pm:*`）在主 README 中有文件說明
- 命令遵循 `/rules/` 中定義的規則
